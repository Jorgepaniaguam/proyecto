#include <iostream>
#include <string>
#include <cstdlib>
#include <ctime>

using namespace std;

struct SLibro {
	string sTitulo;
	string sAutor;
	string sISBN;
	int nAnoPublicacion;
	string sGenero;
	string sEditorial;
	int nNumPaginas;
};

struct SUsuario {
	int nIdUsuario;
	string sNombre;
	string sApellido;
	string sCorreoElectronico;
	string sDireccion;
};

struct SBibliotecario {
	int nIdEmpleado;
	string sNombre;
	string sApellido;
	string sCorreoElectronico;
	string sDepartamento;
};

string sTitulosLibros[] = {"Canción de hielo y fuego", "1984", "El juego de Ender", "Introducción a la programación", "Programación avanzada"};
string sAutoresLibros[] = {"George R.R. Martin", "George Orwell", "Orson Scott Card", "Autor 1", "Autor 2"};
int nAnosLibros[] = {1985, 1949, 1956, 2020, 2022};
string sISBNs[] = {"1", "2", "3", "4", "5"};
string sGeneros[] = {"Fantasía", "Ciencia ficción", "Ficción", "Tecnología", "Tecnología"};
string sEditoriales[] = {"Editorial A", "Editorial B", "Editorial C", "Editorial D", "Editorial E"};
string sNombresUsuarios[] = {"Juan", "Maria", "Pedro"};
string sApellidosUsuarios[] = {"Gomez", "Lopez", "Martinez"};
string sDirecciones[] = {"CALLE PEREZ", "CALLE ABUNA", "CALLE ITENEZ"};
string sNombresBibliotecarios[] = {"Ana", "Carlos", "Luis"};
string sApellidosBibliotecarios[] = {"Perez", "Rodriguez", "Garcia"};
string sDepartamentosBibliotecarios[] = {"Sección de Ficción", "Sección de No Ficción", "Sección Infantil"};

void LlenarDatos(SLibro libros[], int nNumLibros, SUsuario usuarios[], int nNumUsuarios, SBibliotecario bibliotecarios[], int nNumBibliotecarios, int libroIndex = 0, int usuarioIndex = 0, int bibliotecarioIndex = 0) {
	// Llenar datos para libros
	if (libroIndex < nNumLibros) {
		libros[libroIndex] = {sTitulosLibros[libroIndex], sAutoresLibros[libroIndex], sISBNs[libroIndex], nAnosLibros[libroIndex], sGeneros[libroIndex], sEditoriales[libroIndex], rand() % 401 + 100};
		LlenarDatos(libros, nNumLibros, usuarios, nNumUsuarios, bibliotecarios, nNumBibliotecarios, libroIndex + 1, usuarioIndex, bibliotecarioIndex);
	}
	// Llenar datos para usuarios
	if (usuarioIndex < nNumUsuarios) {
		usuarios[usuarioIndex] = {usuarioIndex + 1, sNombresUsuarios[usuarioIndex], sApellidosUsuarios[usuarioIndex], "", sDirecciones[usuarioIndex]};
		// Generar correo electrónico para usuario
		usuarios[usuarioIndex].sCorreoElectronico = sNombresUsuarios[usuarioIndex] + sApellidosUsuarios[usuarioIndex] + "@gmail.com";
		LlenarDatos(libros, nNumLibros, usuarios, nNumUsuarios, bibliotecarios, nNumBibliotecarios, libroIndex, usuarioIndex + 1, bibliotecarioIndex);
	}
	// Llenar datos para bibliotecarios
	if (bibliotecarioIndex < nNumBibliotecarios) {
		bibliotecarios[bibliotecarioIndex] = {bibliotecarioIndex + 1, sNombresBibliotecarios[bibliotecarioIndex], sApellidosBibliotecarios[bibliotecarioIndex], "", sDepartamentosBibliotecarios[bibliotecarioIndex]};
		// Generar correo electrónico para bibliotecario
		bibliotecarios[bibliotecarioIndex].sCorreoElectronico = sNombresBibliotecarios[bibliotecarioIndex] + sApellidosBibliotecarios[bibliotecarioIndex] + "@gmail.com";
		LlenarDatos(libros, nNumLibros, usuarios, nNumUsuarios, bibliotecarios, nNumBibliotecarios, libroIndex, usuarioIndex, bibliotecarioIndex + 1);
	}
}

void ImprimirLibros(const SLibro libros[], int nNumLibros, int nIndex = 0) {
	if (nIndex == nNumLibros) return;
	cout << "Libro " << nIndex + 1 << ": ";
	cout << "Título: " << libros[nIndex].sTitulo << ", ";
	cout << "Autor: " << libros[nIndex].sAutor << ", ";
	cout << "ISBN: " << libros[nIndex].sISBN << ", ";
	cout << "Año de Publicación: " << libros[nIndex].nAnoPublicacion << ", ";
	cout << "Género: " << libros[nIndex].sGenero << ", ";
	cout << "Editorial: " << libros[nIndex].sEditorial << ", ";
	cout << "Número de Páginas: " << libros[nIndex].nNumPaginas << endl;
	ImprimirLibros(libros, nNumLibros, ++nIndex);
}

void ImprimirUsuario(const SUsuario &usuario) {
	cout << "Usuario " << usuario.nIdUsuario << ": "
		<< "Nombre: " << usuario.sNombre << " "
		<< "Apellido: " << usuario.sApellido << " "
		<< "Correo Electrónico: " << usuario.sCorreoElectronico << " "
		<< "Dirección: " << usuario.sDireccion << endl;
}

void ImprimirBibliotecario(const SBibliotecario &bibliotecario) {
	cout << "Bibliotecario " << bibliotecario.nIdEmpleado << ": "
		<< "Nombre: " << bibliotecario.sNombre << " "
		<< "Apellido: " << bibliotecario.sApellido << " "
		<< "Correo Electrónico: " << bibliotecario.sCorreoElectronico << " "
		<< "Departamento: " << bibliotecario.sDepartamento << endl;
}

void BuscarUsuario(const string& sNombre, const string& sApellido, const SUsuario usuarios[], int nNumUsuarios) {
	int contadorNombre = 0;
	int contadorApellido = 0;
	
	for (int i = 0; i < nNumUsuarios; ++i) {
		if (usuarios[i].sNombre.find(sNombre) != string::npos) {
			contadorNombre++;
		}
		if (usuarios[i].sApellido.find(sApellido) != string::npos) {
			contadorApellido++;
			cout << "Usuario encontrado:" << endl;
			ImprimirUsuario(usuarios[i]);
		}
	}
	
	cout << "Coincidencias en nombre: " << contadorNombre << endl;
	cout << "Coincidencias en apellido: " << contadorApellido << endl;
}


void BuscarBibliotecario(const string& sNombre, const string& sApellido, const SBibliotecario bibliotecarios[], int nNumBibliotecarios) {
	int contadorNombre = 0;
	int contadorApellido = 0;
	
	for (int i = 0; i < nNumBibliotecarios; ++i) {
		if (bibliotecarios[i].sNombre.find(sNombre) != string::npos) {
			contadorNombre++;
		}
		if (bibliotecarios[i].sApellido.find(sApellido) != string::npos) {
			contadorApellido++;
			cout << "Bibliotecario encontrado:" << endl;
			ImprimirBibliotecario(bibliotecarios[i]);
		}
	}
	
	cout << "Coincidencias en nombre: " << contadorNombre << endl;
	cout << "Coincidencias en apellido: " << contadorApellido << endl;
}

void BuscarLibro(const string& sBusqueda, const SLibro libros[], int nNumLibros) {
	int contador = 0;
	cout << "Resultado de la búsqueda para \"" << sBusqueda << "\": ";
	for (int i = 0; i < nNumLibros; ++i) {
		if (libros[i].sTitulo.find(sBusqueda) != string::npos) {
			contador++;
			cout << endl << "-" << libros[i].sTitulo;
		}
	}
	cout << endl;
	cout << "Total de libros encontrados: " << contador << endl;
}

int main() {
	const int NUM_LIBROS = 5;
	const int NUM_USUARIOS = 3;
	const int NUM_BIBLIOTECARIOS = 3;
	
	srand(time(nullptr));
	
	SLibro libros[NUM_LIBROS];
	SUsuario usuarios[NUM_USUARIOS];
	SBibliotecario bibliotecarios[NUM_BIBLIOTECARIOS];
	
	int opcion;
	do {
		cout << "MENU" << endl;
		cout << "1) Llenar Datos" << endl;
		cout << "2) Listados" << endl;
		cout << "3) Búsqueda" << endl;
		cout << "0) Salir" << endl;
		cout << "Ingrese una opción: ";
		cin >> opcion;
		
		switch (opcion) {
		case 1: {
			LlenarDatos(libros, NUM_LIBROS, usuarios, NUM_USUARIOS, bibliotecarios, NUM_BIBLIOTECARIOS);
			cout << "Datos llenados exitosamente." << endl;
			cout << "Presione Enter para continuar..." << endl;
			cin.ignore(); // Para esperar a que el usuario presione Enter
			cin.get();    // Para esperar a que el usuario presione Enter
			break;
		}
		case 2: {
			char subopcion;
			do {
				cout << "SUBMENU DE LISTADOS" << endl;
				cout << "A) Lista de Usuarios" << endl;
				cout << "B) Lista de Bibliotecarios" << endl;
				cout << "C) Lista de Libros" << endl;
				cout << "X) Salir" << endl;
				cout << "Ingrese una opción: ";
				cin >> subopcion;
				
				switch (subopcion) {
				case 'A':
				case 'a':
					for (int i = 0; i < NUM_USUARIOS; ++i) {
						ImprimirUsuario(usuarios[i]);
					}
					break;
				case 'B':
				case 'b':
					for (int i = 0; i < NUM_BIBLIOTECARIOS; ++i) {
						ImprimirBibliotecario(bibliotecarios[i]);
					}
					break;
				case 'C':
				case 'c':
					ImprimirLibros(libros, NUM_LIBROS);
					break;
				case 'X':
				case 'x':
					break;
				default:
					cout << "Opción no válida." << endl;
				}
			} while (subopcion != 'X' && subopcion != 'x');
			break;
		}
		case 3: {
			char subopcion;
			do {
				cout << "SUBMENU DE BUSQUEDA" << endl;
				cout << "A) Búsqueda de Libro (Título)" << endl;
				cout << "B) Búsqueda de Usuario (Nombre y Apellido)" << endl;
				cout << "C) Búsqueda de Bibliotecario (Nombre y Apellido)" << endl;
				cout << "X) Salir" << endl;
				cout << "Ingrese una opción: ";
				cin >> subopcion;
				
				switch (subopcion) {
				case 'A':
				case 'a': {
					string sTitulo;
					cout << "Ingrese el título del libro a buscar: ";
					cin.ignore();
					getline(cin, sTitulo);
					BuscarLibro(sTitulo, libros, NUM_LIBROS);
					break;
				}
				case 'B':
				case 'b': {
					string sNombre, sApellido;
					cout << "Ingrese el nombre del usuario: ";
					cin >> sNombre;
					cout << "Ingrese el apellido del usuario: ";
					cin >> sApellido;
					BuscarUsuario(sNombre, sApellido, usuarios, NUM_USUARIOS);
					break;
				}
				case 'C':
				case 'c': {
					string sNombre, sApellido;
					cout << "Ingrese el nombre del bibliotecario: ";
					cin >> sNombre;
					cout << "Ingrese el apellido del bibliotecario: ";
					cin >> sApellido;
					BuscarBibliotecario(sNombre, sApellido, bibliotecarios, NUM_BIBLIOTECARIOS);
					break;
				}
				case 'X':
				case 'x':
					break;
				default:
					cout << "Opción no válida." << endl;
				}
			} while (subopcion != 'X' && subopcion != 'x');
			break;
		}
		case 0:
			cout << "Saliendo del programa." << endl;
			break;
		default:
			cout << "Opción no válida." << endl;
		}
	} while (opcion != 0);
	
	return 0;
}


